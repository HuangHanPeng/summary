# 第六周学习

## 定时器

### 三种定时器的区别

#### #高级定时器（TIM1,TIM8）——PWM

##### 通用定时器（TIM2~5）——定时 计数，pwm

##### 基本定时器（TIM6~7）——驱动DAC



### 通用定时器的特点

1. 低速APB1总线上
2. 16位自动装载计数器，16位可编程预分频器
3. 4个独立通道
   * 输入捕获输出
   * 输出比较
   * PWM生成
   * 单脉冲模式

4. 定时器中断触发：
   * 更新：计数器溢出，计数器初始化
   * 触发事件：外部触发
   * 输入捕获
   * 输出比较

### 通用定时器工作过程

##### 计数模式：

1. 向上计数：

   > ##### 从0记数到自动装入值至产生溢出，并从0开始记数

2. 向下：

   > ##### 从装入值开始计数至0，产生溢出并从装入值开始计数

3. 中央对齐模式：

   > ##### 从0开始计数到装入值-1产生溢出，向下计数至1，又产生溢出，之后从开始。

定时器结构：

时钟部分——时计单元（计数器，自动重装载器，预分频器）——输入捕获——输出比较

时钟：

1. 内部时钟——APB1
2. 外部引脚输入（定时器2，3，4）——ETR寄存器
3. 其他定时器

通过触发控制器传输信号到时计单元

#### 定时器中断：

> 过程： 时钟选择——预分频，装载值——中断
>
> ##### 时钟选择：
>
> 内部时钟：AHB——APB1——CK_INT时钟
>
> > CK_INT时钟 = APB1*2（分频系数不为1时）、
> >
> > 而分频系数 = AHB/APB1（调用system函数）
>
> 计数过程：
>
> 使能——选择模式——溢出产生中断标志，执行中断
>
> 实验部分；
>
> 定时器配置：
>
> 1.配置自动装载值，预分频系数，模式
>
> 2.定时器使能
>
> 3.定时器中断使能
>
> 4.标志类获取
>
> 中断实现；
>
> 1. 使能时钟
>
> 2. 初始化定时器，配置ARR,PSC寄存器
>
> 3. 开启中断配置NVIC
>
> 4. 使能定时器
>
> 5. 编写中断服务函数
>
>    #### 计数计算：
>
>    ##### Tout（溢出时间）=（ARR+1）(PSC+1)/Tclk
>
>    > 溢出时间由时钟频率和自动装载值决定
>
>    > ARR:自动装载值
>
>    > PSC：预分频系数
>
>    > (PSC+1)/Tclk为计时器时钟频率
>
>    
>
>    

## 总结

### 上周和本周都比较繁忙，上周主要是写项目文档，和学习ppt的使用，本周也在赶课程进度，本次先提交定时器中断部分的笔记，之后的例程练习的代码会陆续上传。	